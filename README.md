# <p align="center">Домашнее задание к занятию "Репликация и масштабирование. Часть 2"</p>

**SDBSQL-46 / Ларионов Сергей**

---

## Задание 1: Различия master-slave и master-master

### Активный master‑сервер и пассивный репликационный slave‑сервер

Основные преимущества:
- Отказоустойчивость. Пассивный slave‑сервер выступает «горячим резервом»: в случае сбоя master‑сервера можно оперативно переключиться на реплику, минимизируя время простоя.
- Безопасность данных. Репликация обеспечивает постоянное копирование данных на slave‑сервер, что снижает риск потери информации при аппаратных или программных сбоях.
- Возможность резервного копирования без нагрузки на основной сервер. Резервные копии можно снимать с slave‑сервера, не замедляя работу основного приложения.
- Простота архитектуры. Схема с одним master и одним slave относительно легка в настройке и мониторинге, требует меньше ресурсов на сопровождение.
- Тестирование и отладка. На slave‑сервере можно разворачивать тестовые среды, анализировать данные или отрабатывать обновления, не затрагивая рабочую систему.

### Master‑сервер и несколько slave‑серверов

Основные преимущества:
- Горизонтальное масштабирование чтения. Запросы на чтение (SELECT) можно распределять между несколькими slave‑серверами, существенно повышая общую производительность системы при высокой нагрузке.
- Повышенная отказоустойчивость. Наличие нескольких реплик снижает риск полной потери доступности: даже если один slave выйдет из строя, остальные продолжат обслуживать запросы.
- Географическое распределение. Slave‑серверы можно разместить в разных дата‑центрах или регионах, сокращая задержки для пользователей и обеспечивая локальный доступ к данным.
- Разделение нагрузок. Разные slave‑серверы могут быть оптимизированы для конкретных задач: один — для отчётов, другой — для аналитики, третий — для резервного копирования. Это предотвращает конкуренцию ресурсов.
- Плавное масштабирование. При росте нагрузки можно добавлять новые slave‑серверы без остановки основной системы, адаптируя инфраструктуру под текущие потребности.
- Снижение нагрузки на master. Большинство операций чтения переносится на реплики, что позволяет master‑серверу эффективнее обрабатывать записи (INSERT/UPDATE/DELETE) и поддерживать консистентность данных.
- Гибкость в обновлении. Можно поэтапно обновлять slave‑серверы, проверяя совместимость и производительность, прежде чем применять изменения к master.

### Сравнительная таблица преимуществ двух схем масштабирования:

| Критерий                            | Master + пассивный slave                                               | Master + несколько slave                                                                 |
|-------------------------------------|------------------------------------------------------------------------|------------------------------------------------------------------------------------------|
| **Отказоустойчивость**              | Базовый уровень: есть горячий резерв для переключения при сбоях master | Повышенный уровень: несколько реплик снижают риск полной потери доступности              |
| **Масштабирование чтения**          | Отсутствует: slave обычно не используется для клиентских запросов      | Высокое: запросы на чтение распределяются между репликами, что снимает нагрузку с master |
| **Нагрузка на master**              | Средняя: все операции чтения идут через master                         | Низкая: большинство операций чтения перенесено на slave‑серверы                          |
| **Резервное копирование**           | Возможно с slave без нагрузки на master                                | Возможно с любого из slave, что даёт гибкость в планировании бэкапов                     |
| **Географическое распределение**    | Ограничено: обычно одна реплика в том же или соседнем ЦОД              | Возможно: реплики размещаются в разных регионах для снижения задержек                    |
| **Сложность управления**            | Низкая: простая архитектура, легко мониторить и настраивать            | Средняя/высокая: требуется координация нескольких реплик, контроль консистентности       | 
| **Затраты на инфраструктуру**       | Низкие: минимум дополнительного оборудования                           | Средние/высокие: требуется несколько серверов и каналы связи                             |
| **Тестирование и аналитика**        | Возможно на slave, но в ограниченном объёме                            | Гибкое: разные slave можно выделить под конкретные задачи (отчёты, аналитика, тесты)     |
| **Время восстановления после сбоя** | Минимальное: переключение на готовую реплику                           | Минимальное: возможность выбора рабочей реплики для переключения                         |
| **Гибкость масштабирования**        | Низкая: добавление новых узлов не предусмотрено                        | Высокая: можно добавлять slave по мере роста нагрузки                                    |

### Примечания:

- В схеме «master + пассивный slave» slave чаще всего находится в режиме ожидания и активируется только при аварии.
- В схеме «master + несколько slave» реплики активно участвуют в обработке запросов, что требует настройки балансировки нагрузки и мониторинга синхронизации.
- Обе схемы предполагают асинхронную или синхронную репликацию, выбор которой влияет на консистентность данных и задержки.

---

## Задание 2: Конфигурация master-slave репликации MySQL


Конфигурация включает server-id=1 и включённый бинарный лог:
```bash
server-id = 1
log_bin = /var/log/mysql/mysql-bin.log
max_binlog_size = 100M
```

<img src="img/image1.png" alt="Конфигурация master" width="650"/>


```bash
text
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| server_id     | 2     |
+---------------+-------+
```

---
